### 前言

KubeMin-Cli 是一个基于云原生的PaaS平台，以轻量化工作流的方式来描述应用，项目中的APP结构模型基于 **(Open Application Model)OAM**。不同于Kubevela 或其他DevOps平台呈现出来的配置化参数，这些特征都是基于k8s的底层资源进行抽象，对开发者来说需要一定的认知，无形中提高了操作的门槛和复杂性。KubeMin-Cli希望进一步降低这些门槛，构建更加通用的数据结构。



### 架构图











### OAM Traits (特征)

#### storage 存储

Storage支持多种存储方式，比如`persistent`稳定存储，它对应的是Kubernetes中的 PersistentVolumeClaim 和 VolumeMount 属性。在KubeMin-Cli中为了简化表达使用: `{"type":"persistent","mountPath":"/data","size": "20"}`Json格式对组件提出存储方面的附加追述。

| **type**     | **对应 Kubernetes 资源**            | 说明                                                         |
| ------------ | ----------------------------------- | ------------------------------------------------------------ |
| persistent   | PersistentVolumeClaim + VolumeMount | 稳定的存储，使用`PersistentVolumeClaim`卷用于将持久卷(PersistentVolume)挂载到Pod中。这种方式可以为Pod提供一个稳定的存储方式，**不会因为重启/Pod崩溃而丢失容器内持久化存储的文件**。 |
| ephemeral    | emptyDir + VolumeMount              | 临时存储，对于定义了 `emptyDir` 卷的 Pod，在 Pod 被指派到某节点时此卷会被创建。 就像其名称所表示的那样，`emptyDir` 卷最初是空的。尽管 Pod 中的容器挂载 `emptyDir` 卷的路径可能相同也可能不同，但这些容器都可以读写 `emptyDir` 卷中相同的文件。 当 Pod 因为某些原因被从节点上删除时，`emptyDir` 卷中的数据也会被永久删除。 |
| host-mounted | hostPath + VolumeMount              | hostPath 可以让主机节点文件系统上的文件或目录挂载到Pod中，比如运行一个需要访问节点级系统组件的容器；让存储在主机系统上的配置文件可以被[静态 Pod](https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/static-pod/) 以只读方式访问 |
| config       | ConfigMap + VolumeMount 或 EnvFrom  | 如果在Storage特征中定义config那么KubeMin会将其视为:在Pod中将ConfigMap当作文件使用 |
| secret       | Secret + VolumeMount 或 EnvFrom     | 如果在Storage特征中定义secret那么KubeMin会将其视为:在Pod中将secret当作文件使用 |



#### 实际用例

1.创建一个**稳定存储**

```json

```



